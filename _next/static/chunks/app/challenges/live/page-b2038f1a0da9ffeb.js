(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{10:(e,t,a)=>{"use strict";a.d(t,{$v:()=>p,EO:()=>u,Lt:()=>d,Rx:()=>f,Zr:()=>v,ck:()=>x,r7:()=>g,tv:()=>c,wd:()=>h});var s=a(5155),r=a(2115),l=a(4520),i=a(9434),n=a(285);let d=l.bL,c=l.l9,o=l.ZL,m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});m.displayName=l.hJ.displayName;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(m,{}),(0,s.jsx)(l.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});u.displayName=l.UC.displayName;let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};h.displayName="AlertDialogHeader";let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="AlertDialogFooter";let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold",a),...r})});g.displayName=l.hE.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});p.displayName=l.VY.displayName;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.rc,{ref:t,className:(0,i.cn)((0,n.r)(),a),...r})});f.displayName=l.rc.displayName;let v=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.ZD,{ref:t,className:(0,i.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});v.displayName=l.ZD.displayName},518:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(157).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(5155),r=a(2115),l=a(9434);let i=r.forwardRef((e,t)=>{let{className:a,type:r,...i}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},4944:(e,t,a)=>{"use strict";a.d(t,{k:()=>n});var s=a(5155),r=a(2115),l=a(5863),i=a(9434);let n=r.forwardRef((e,t)=>{let{className:a,value:r,indicatorClassName:n,...d}=e;return(0,s.jsx)(l.bL,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...d,children:(0,s.jsx)(l.C1,{className:(0,i.cn)("h-full w-full flex-1 bg-primary transition-all",n),style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});n.displayName=l.bL.displayName},5318:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(157).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>d,TN:()=>o,XL:()=>c});var s=a(5155),r=a(2115),l=a(2085),i=a(9434);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:r}),a),...l})});d.displayName="Alert";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});c.displayName="AlertTitle";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...r})});o.displayName="AlertDescription"},6126:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var s=a(5155);a(2115);var r=a(2085),l=a(9434);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)(i({variant:a}),t),...r})}},6983:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>G});var s=a(5155),r=a(2115),l=a(2825),i=a(6695),n=a(285),d=a(4944),c=a(6478),o=a(6126),m=a(5365),u=a(172),h=a(5268),x=a(157);let g=(0,x.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),p=(0,x.A)("RadioTower",[["path",{d:"M4.9 16.1C1 12.2 1 5.8 4.9 1.9",key:"s0qx1y"}],["path",{d:"M7.8 4.7a6.14 6.14 0 0 0-.8 7.5",key:"1idnkw"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}],["path",{d:"M16.2 4.8c2 2 2.26 5.11.8 7.47",key:"ojru2q"}],["path",{d:"M19.1 1.9a9.96 9.96 0 0 1 0 14.1",key:"rhi7fg"}],["path",{d:"M9.5 18h5",key:"mfy3pd"}],["path",{d:"m8 22 4-11 4 11",key:"25yftu"}]]);var f=a(4347);let v=(0,x.A)("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),b=(0,x.A)("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),j=(0,x.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),N=(0,x.A)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),y=(0,x.A)("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),w=(0,x.A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),k=(0,x.A)("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);var C=a(8761),A=a(518),S=a(5318);let T=(0,x.A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);var M=a(7223),R=a(2523),P=a(8539),D=a(9434),E=a(7481),L=a(6874),O=a.n(L),F=a(5695),z=a(10),$=a(9576);let U=e=>{let t=Math.floor(e/3600),a=Math.floor(e%3600/60),s=Math.floor(e%60);return"".concat(String(t).padStart(2,"0"),":").concat(String(a).padStart(2,"0"),":").concat(String(s).padStart(2,"0"))};function G(){var e;let{isAdmin:t}=(0,$.A)(),[a,x]=(0,r.useState)(null),[L,G]=(0,r.useState)(!0),[Z,I]=(0,r.useTransition)(),{toast:q}=(0,E.dj)(),_=(0,F.useRouter)(),[B,W]=(0,r.useState)({}),[V,X]=(0,r.useState)(!1),[Y,H]=(0,r.useState)(!1),[J,K]=(0,r.useState)({}),[Q,ee]=(0,r.useState)(""),[et,ea]=(0,r.useState)(null),[es,er]=(0,r.useState)(""),[el,ei]=(0,r.useState)(null),en=(0,r.useCallback)(async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e&&G(!0);try{let e=await (0,l.Co)();x(e)}catch(e){console.error("Failed to fetch live page data:",e),q({title:"Error Loading Challenge",description:"Could not fetch the current challenge data.",variant:"destructive"}),x(null)}e&&G(!1)},[q]);(0,r.useEffect)(()=>{en()},[en]),(0,r.useEffect)(()=>{if(!a||"live"!==a.status&&"upcoming"!==a.status){if(a&&void 0!==a.challengeAccumulatedDuration){let e={};e.overall=U(a.challengeAccumulatedDuration||0),a.games.forEach(t=>{e[t.id]=U(t.accumulatedDuration||0)}),W(e)}else W({});return}let e=setInterval(()=>{if(a){let e={},t=a.challengeAccumulatedDuration||0;"live"===a.status&&a.isChallengeTimerActive&&a.challengeStartedAt&&(t+=(Date.now()-a.challengeStartedAt)/1e3),e.overall=U(t),a.games.forEach(t=>{let s=t.accumulatedDuration||0;"live"===a.status&&t.isTimerActive&&t.timerStartedAt&&(s+=(Date.now()-t.timerStartedAt)/1e3),e[t.id]=U(s)}),W(e)}},1e3);return()=>clearInterval(e)},[a]);let ed=async function(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};I(async()=>{try{let r=await e();s.onSuccessSetNull?(x(null),q({title:t,variant:"default"})):r?(q({title:t,variant:"default"}),!1!==s.optimisticUpdate&&x(r),s.refetchOnSuccess&&await en(!1)):(q({title:a||"Action reported no change or failed",description:"Please check the challenge state.",variant:"destructive"}),await en(!1))}catch(e){console.error(a||"Action error:",e),q({title:"Error",description:e.message||"An unexpected error occurred.",variant:"destructive"}),await en(!1)}})},ec=e=>{if(a&&"live"===a.status){let t=a.games.find(t=>t.id===e);ed(()=>(0,l.K5)(a.id,e),'Game Timer for "'.concat(null==t?void 0:t.name,'" ').concat((null==t?void 0:t.isTimerActive)&&a.activeGameId===t.id?"Paused":"Started/Resumed"),"Failed to toggle game timer",{refetchOnSuccess:!0,optimisticUpdate:!0})}},eo=e=>{if(a&&"live"===a.status){var t;let s=(null===(t=a.games.find(t=>t.id===e))||void 0===t?void 0:t.name)||"Game",r=J[e]||"";ed(()=>(0,l.jW)(a.id,e,1,r),"Progress updated for ".concat(s),"Failed to update progress",{refetchOnSuccess:!0,optimisticUpdate:!0}),K(t=>({...t,[e]:""}))}},em=e=>{if(a&&"live"===a.status){var t;let s=(null===(t=a.games.find(t=>t.id===e))||void 0===t?void 0:t.name)||"Game",r=J[e]||"";ed(()=>(0,l.Od)(a.id,e,r),"Attempt logged for ".concat(s),"Failed to log attempt",{refetchOnSuccess:!0,optimisticUpdate:!0}),K(t=>({...t,[e]:""}))}},eu=(e,t)=>{ea(e),er(t)},eh=()=>{ea(null),er("")},ex=()=>{a&&null!==et&&es.trim()?(ed(()=>(0,l._Y)(a.id,et,es.trim()),"Note updated.","Failed to update note.",{refetchOnSuccess:!0,optimisticUpdate:!0}),eh()):es.trim()||q({title:"Cannot save an empty note",variant:"destructive"})},eg=()=>{a&&null!==el&&ed(()=>(0,l.Ju)(a.id,el),"Note deleted.","Failed to delete note.",{refetchOnSuccess:!0,optimisticUpdate:!0}),ei(null)};if(L&&!Z)return(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center h-64",children:[(0,s.jsx)(u.A,{className:"h-10 w-10 animate-spin text-primary"}),(0,s.jsx)("span",{className:"ml-4 text-xl text-muted-foreground mt-4",children:"Loading Live Dashboard..."})]});if(!a||"live"!==a.status&&"upcoming"!==a.status)return(0,s.jsxs)(m.Fc,{variant:"default",className:"border-primary bg-primary/5 text-primary dark:bg-primary/10 dark:text-primary-foreground/90 rounded-lg p-6",children:[(0,s.jsx)(h.A,{className:"h-6 w-6 !text-primary mr-3"}),(0,s.jsx)(m.XL,{className:"text-xl font-semibold mb-1",children:"No Active or Upcoming Challenge"}),(0,s.jsxs)(m.TN,{children:["The arena is currently quiet. A new challenge might be brewing ",t&&(0,s.jsxs)(s.Fragment,{children:["or you can ",(0,s.jsx)(O(),{href:"/admin/create-challenge",className:"font-semibold underline hover:text-primary/80",children:"create one"}),"!"]}),(0,s.jsxs)(n.$,{onClick:()=>en(),variant:"outline",size:"sm",className:"ml-4",disabled:Z||L,children:[(0,s.jsx)(g,{className:(0,D.cn)("mr-2 h-4 w-4",(Z||L)&&"animate-spin")})," Retry Load"]})]})]});let ep="live"===a.status,ef="upcoming"===a.status;return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)(i.Zp,{className:(0,D.cn)("shadow-2xl border-2 rounded-xl overflow-hidden",ep?"border-destructive":ef?"border-accent":"border-primary"),children:(0,s.jsxs)(i.aR,{className:(0,D.cn)("p-6",ep?"bg-destructive/10 dark:bg-destructive/20":ef?"bg-accent/10 dark:bg-accent/20":"bg-primary/10 dark:bg-primary/20"),children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(p,{className:(0,D.cn)("h-10 w-10",ep?"text-destructive":ef?"text-accent":"text-primary",ep&&a.isChallengeTimerActive&&"animate-ping absolute opacity-70")}),(0,s.jsx)(p,{className:(0,D.cn)("h-10 w-10 relative",ep?"text-destructive":ef?"text-accent":"text-primary",!ep&&!ef&&"opacity-50",ep&&!a.isChallengeTimerActive&&"opacity-60")}),(0,s.jsx)(i.ZB,{className:(0,D.cn)("text-3xl lg:text-4xl font-extrabold",ep?"text-destructive":ef?"text-accent":"text-primary"),children:a.title})]}),(0,s.jsxs)(o.E,{variant:ep?"destructive":ef?"default":"secondary",className:(0,D.cn)("text-lg px-4 py-2 shadow-md self-start sm:self-center",ef&&"bg-accent text-accent-foreground"),children:[a.status.toUpperCase()," ",!1===a.isChallengeTimerActive&&"live"===a.status?"(PAUSED)":""]})]}),(0,s.jsxs)(i.BT,{className:"text-xl mt-3 font-medium",children:["Challenge Duration: ",(0,s.jsx)("span",{className:"font-bold text-foreground tabular-nums",children:B.overall||U(a.challengeAccumulatedDuration||0)})]}),ef&&t&&(0,s.jsxs)(n.$,{onClick:()=>{a&&"upcoming"===a.status&&ed(()=>(0,l.O5)(a.id),"Challenge Started!","Failed to start challenge",{refetchOnSuccess:!1,optimisticUpdate:!0})},size:"lg",className:"mt-4 w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white shadow-lg text-base py-3",disabled:Z,children:[Z&&"upcoming"===a.status?(0,s.jsx)(u.A,{className:"mr-2 h-6 w-6 animate-spin"}):(0,s.jsx)(f.A,{className:"mr-2 h-6 w-6"}),Z&&"upcoming"===a.status?"Starting...":"Start This Challenge"]})]})}),t&&(0,s.jsxs)(i.Zp,{className:"shadow-md rounded-lg border",children:[(0,s.jsx)(i.aR,{className:"pb-4",children:(0,s.jsxs)(i.ZB,{className:"text-xl flex items-center gap-2",children:[(0,s.jsx)(v,{className:"h-5 w-5 text-primary"}),"Admin Controls"]})}),(0,s.jsxs)(i.Wu,{className:"flex flex-wrap gap-3",children:[ep&&(0,s.jsxs)(n.$,{onClick:()=>{a&&"live"===a.status&&ed(()=>(0,l.lM)(a.id),"Challenge Timer ".concat(a.isChallengeTimerActive?"Paused":"Resumed"),"Failed to toggle challenge timer",{refetchOnSuccess:!0,optimisticUpdate:!0})},variant:"outline",className:"shadow-sm",disabled:Z,children:[Z&&a.isChallengeTimerActive?(0,s.jsx)(u.A,{className:"mr-2 h-5 w-5 animate-spin"}):a.isChallengeTimerActive?(0,s.jsx)(b,{className:"mr-2 h-5 w-5 text-red-500"}):(0,s.jsx)(f.A,{className:"mr-2 h-5 w-5 text-green-500"}),Z&&a.isChallengeTimerActive?"Pausing...":Z&&!a.isChallengeTimerActive?"Resuming...":a.isChallengeTimerActive?"Pause Challenge Clock":"Resume Challenge Clock"]}),(0,s.jsxs)(z.Lt,{open:V,onOpenChange:X,children:[(0,s.jsx)(z.tv,{asChild:!0,children:(0,s.jsxs)(n.$,{variant:"outline",className:"text-amber-600 border-amber-500 hover:bg-amber-50 hover:text-amber-700 shadow-sm",disabled:Z,onClick:()=>X(!0),children:[(0,s.jsx)(j,{className:"mr-2 h-5 w-5"}),"Reset Full Challenge State"]})}),(0,s.jsxs)(z.EO,{children:[(0,s.jsxs)(z.wd,{children:[(0,s.jsx)(z.r7,{children:"Are you absolutely sure?"}),(0,s.jsx)(z.$v,{children:"This action will reset all progress, timers, and status for this challenge back to 'upcoming' (scheduled for 2 days from now). This cannot be undone."})]}),(0,s.jsxs)(z.ck,{children:[(0,s.jsx)(z.Zr,{disabled:Z,children:"Cancel"}),(0,s.jsxs)(z.Rx,{onClick:()=>{a?ed(()=>(0,l.tT)(a.id),"Challenge state has been reset to upcoming.","Failed to reset challenge.",{optimisticUpdate:!0,refetchOnSuccess:!0}):(q({title:"No Challenge",description:"No challenge loaded to reset.",variant:"default"}),en()),X(!1)},disabled:Z,className:"bg-amber-600 hover:bg-amber-700",children:[Z&&V?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,Z&&V?"Resetting...":"Yes, reset it!"]})]})]})]}),ep&&(0,s.jsxs)(z.Lt,{open:Y,onOpenChange:H,children:[(0,s.jsx)(z.tv,{asChild:!0,children:(0,s.jsxs)(n.$,{variant:"destructive",className:"shadow-sm",disabled:Z,onClick:()=>H(!0),children:[(0,s.jsx)(N,{className:"mr-2 h-5 w-5"}),"End Challenge Now"]})}),(0,s.jsxs)(z.EO,{children:[(0,s.jsxs)(z.wd,{children:[(0,s.jsx)(z.r7,{children:"Confirm End Challenge"}),(0,s.jsx)(z.$v,{children:"Are you sure you want to end this challenge? It will be moved to 'Past Challenges' and all timers will be stopped. This action cannot be undone."})]}),(0,s.jsxs)(z.ck,{children:[(0,s.jsx)(z.Zr,{disabled:Z,children:"Cancel"}),(0,s.jsxs)(z.Rx,{onClick:()=>{a&&"live"===a.status&&ed(()=>(0,l.fX)(a.id),"Challenge Ended and Marked as Past.","Failed to end challenge.",{onSuccessSetNull:!0,refetchOnSuccess:!1}),H(!1)},disabled:Z,className:"bg-destructive hover:bg-destructive/90",children:[Z&&Y?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,Z&&Y?"Ending...":"Yes, End Challenge"]})]})]})]}),(0,s.jsxs)(n.$,{onClick:()=>{en(),_.refresh()},variant:"outline",size:"sm",className:"shadow-sm",disabled:Z||L,children:[(0,s.jsx)(g,{className:(0,D.cn)("mr-2 h-4 w-4",(Z||L)&&"animate-spin")})," Force Refresh Data"]})]})]}),ep&&(0,s.jsxs)("section",{children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsxs)("h2",{className:"text-2xl md:text-3xl font-semibold flex items-center gap-2",children:[(0,s.jsx)(y,{className:"h-7 w-7 text-primary"})," Game Dashboard"]})}),(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a.games.map(e=>{let r=void 0!==e.currentProgress&&e.targetProgress&&e.targetProgress>0?Math.min(100,e.currentProgress/e.targetProgress*100):0,l="completed"===e.status,m=!0===e.isTimerActive&&a.activeGameId===e.id;return(0,s.jsxs)(i.Zp,{className:(0,D.cn)("shadow-lg rounded-xl flex flex-col transition-all duration-300 border",m?"border-accent ring-2 ring-accent shadow-accent/30":"border-border",l&&"bg-green-50 dark:bg-green-900/20 border-green-500/70"),children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-start gap-4 pb-3 pt-5 px-5",children:[(0,s.jsx)(c.S,{iconName:e.iconName,className:(0,D.cn)("h-12 w-12 mt-1 shrink-0",l?"text-green-600":m?"text-accent":"text-primary")}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)(i.ZB,{className:(0,D.cn)("text-xl font-semibold",l&&"text-green-700 dark:text-green-300",m&&"text-accent"),children:e.name}),(0,s.jsx)(i.BT,{className:"text-sm mt-0.5 line-clamp-2",children:e.objective})]}),e.status&&(0,s.jsxs)(o.E,{variant:l?"default":"secondary",className:(0,D.cn)(l?"bg-green-600 text-white":m?"bg-accent text-accent-foreground":!1===e.isTimerActive&&"completed"!==e.status&&"pending"!==e.status&&"live"===a.status&&e.accumulatedDuration&&e.accumulatedDuration>0?"bg-yellow-400 text-yellow-900":""),children:[e.status.toUpperCase()," ",!1===e.isTimerActive&&"completed"!==e.status&&"pending"!==e.status&&"live"===a.status&&e.accumulatedDuration&&e.accumulatedDuration>0?"(PAUSED)":""]})]}),(0,s.jsxs)(i.Wu,{className:"px-5 pb-4 space-y-3 flex-grow",children:[(0,s.jsxs)("div",{className:(0,D.cn)("text-lg font-medium tabular-nums",m&&"text-accent font-bold"),children:["Game Time: ",B[e.id]||U(e.accumulatedDuration||0)]}),void 0!==e.targetProgress&&null!==e.targetProgress&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Progress"}),(0,s.jsxs)("span",{className:(0,D.cn)("font-semibold",l?"text-green-600":m?"text-accent":"text-foreground"),children:[e.currentProgress||0," / ",e.targetProgress]})]}),(0,s.jsx)(d.k,{value:r,className:"w-full h-2.5 rounded-full",indicatorClassName:(0,D.cn)(l?"bg-green-500":m?"bg-accent":"bg-primary")})]}),e.enableTryCounter&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Attempts: ",(0,s.jsx)("span",{className:"font-semibold text-foreground",children:e.tryCount||0})]})]}),t&&ep&&!l&&(0,s.jsx)(i.wL,{className:"px-5 pb-5 pt-0 border-t mt-auto",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 pt-4 w-full",children:[e.enableManualLog&&(0,s.jsx)(R.p,{type:"text",placeholder:"Log note (e.g., Win 13:3, 5th place)",value:J[e.id]||"",onChange:t=>K(a=>({...a,[e.id]:t.target.value})),className:"text-sm",disabled:Z||!a.isChallengeTimerActive}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 w-full",children:[(0,s.jsxs)(n.$,{onClick:()=>ec(e.id),variant:"outline",size:"sm",className:"flex-1 shadow-sm",disabled:Z||!a.isChallengeTimerActive,children:[Z&&a.activeGameId===e.id&&m?(0,s.jsx)(u.A,{className:"h-4 w-4 animate-spin"}):m?(0,s.jsx)(b,{className:"mr-2 h-4 w-4 text-red-500"}):(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4 text-green-500"}),Z&&a.activeGameId===e.id&&m?"Pausing...":Z&&a.activeGameId===e.id&&!m?"Starting...":Z&&a.activeGameId!==e.id?"Switching...":m?"Pause Game":a.activeGameId&&a.activeGameId!==e.id?"Switch to This":"Start Game"]}),(void 0!==e.targetProgress&&null!==e.targetProgress||e.enableManualLog&&(void 0===e.targetProgress||null===e.targetProgress))&&(0,s.jsxs)(n.$,{onClick:()=>eo(e.id),variant:"outline",size:"sm",disabled:Z||!m||!a.isChallengeTimerActive,className:"shadow-sm",children:[(0,s.jsx)(w,{className:"mr-1 h-4 w-4 text-green-500"})," Win/Incr."]}),e.enableTryCounter&&(0,s.jsxs)(n.$,{onClick:()=>em(e.id),variant:"outline",size:"sm",disabled:Z||!a.isChallengeTimerActive,className:"shadow-sm",children:[(0,s.jsx)(k,{className:"mr-1 h-4 w-4 text-blue-500"})," Log Attempt"]})]})]})}),l&&(0,s.jsx)(i.wL,{className:"px-5 pb-4 pt-3 bg-green-100/50 dark:bg-green-800/20 border-t mt-auto",children:(0,s.jsxs)("div",{className:"flex items-center text-green-600 dark:text-green-400 font-semibold",children:[(0,s.jsx)(h.A,{className:"mr-2 h-5 w-5"})," Game Completed!"]})})]},e.id)})})]}),t&&ep&&(0,s.jsxs)(i.Zp,{className:"shadow-md rounded-lg border mt-8",children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)(i.ZB,{className:"text-xl flex items-center gap-2",children:[(0,s.jsx)(C.A,{className:"h-5 w-5 text-primary"}),"Overall Challenge Notes"]})}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[a.overallNotes&&a.overallNotes.length>0?(0,s.jsx)("ul",{className:"space-y-2.5 text-sm ",children:a.overallNotes.map((e,t)=>(0,s.jsx)("li",{className:"p-3 border rounded-md bg-muted/50 dark:bg-muted/20 flex justify-between items-start group",children:et===t?(0,s.jsxs)("div",{className:"flex-grow flex items-center gap-2",children:[(0,s.jsx)(P.T,{value:es,onChange:e=>er(e.target.value),rows:2,className:"flex-grow",disabled:Z}),(0,s.jsxs)(n.$,{onClick:ex,size:"icon",variant:"ghost",className:"text-green-600 hover:bg-green-100 dark:hover:bg-green-800/50",disabled:Z||!es.trim(),children:[(0,s.jsx)(A.A,{className:"h-4 w-4"})," ",(0,s.jsx)("span",{className:"sr-only",children:"Save"})]}),(0,s.jsxs)(n.$,{onClick:eh,size:"icon",variant:"ghost",className:"text-red-600 hover:bg-red-100 dark:hover:bg-red-800/50",disabled:Z,children:[(0,s.jsx)(S.A,{className:"h-4 w-4"})," ",(0,s.jsx)("span",{className:"sr-only",children:"Cancel"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-muted-foreground flex-grow whitespace-pre-wrap break-words mr-2",children:e}),(0,s.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",children:[(0,s.jsxs)(n.$,{onClick:()=>eu(t,e),size:"icon",variant:"ghost",className:"h-7 w-7 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-800/50",disabled:Z,children:[(0,s.jsx)(T,{className:"h-4 w-4"})," ",(0,s.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,s.jsxs)(z.Lt,{open:el===t,onOpenChange:e=>!e&&ei(null),children:[(0,s.jsx)(z.tv,{asChild:!0,children:(0,s.jsxs)(n.$,{onClick:()=>ei(t),size:"icon",variant:"ghost",className:"h-7 w-7 text-red-600 hover:bg-red-100 dark:hover:bg-red-800/50",disabled:Z,children:[(0,s.jsx)(M.A,{className:"h-4 w-4"})," ",(0,s.jsx)("span",{className:"sr-only",children:"Delete"})]})}),(0,s.jsxs)(z.EO,{children:[(0,s.jsxs)(z.wd,{children:[(0,s.jsx)(z.r7,{children:"Confirm Delete Note"}),(0,s.jsx)(z.$v,{children:"Are you sure you want to delete this note? This cannot be undone."})]}),(0,s.jsxs)(z.ck,{children:[(0,s.jsx)(z.Zr,{onClick:()=>ei(null),disabled:Z,children:"Cancel"}),(0,s.jsxs)(z.Rx,{onClick:eg,disabled:Z,className:"bg-destructive hover:bg-destructive/90",children:[Z&&el===t?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Delete"]})]})]})]})]})]})},t))}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No overall notes added yet."}),null===et&&(0,s.jsxs)("div",{className:"flex gap-2 items-start pt-2",children:[(0,s.jsx)(P.T,{placeholder:"Add a general note for the challenge (e.g., server issues, player morale, etc.)",value:Q,onChange:e=>ee(e.target.value),rows:2,className:"flex-grow",disabled:Z||!a.isChallengeTimerActive}),(0,s.jsxs)(n.$,{onClick:()=>{a&&"live"===a.status&&Q.trim()?(ed(()=>(0,l.$)(a.id,Q.trim()),"Overall note added.","Failed to add overall note.",{refetchOnSuccess:!0,optimisticUpdate:!0}),ee("")):Q.trim()||q({title:"Cannot add empty note",variant:"destructive"})},disabled:Z||!a.isChallengeTimerActive||!Q.trim(),className:"shadow-sm shrink-0",children:[Z&&Q.trim()&&!(null===(e=a.overallNotes)||void 0===e?void 0:e.includes(Q.trim()))?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(k,{className:"mr-2 h-4 w-4"}),"Add Note"]})]})]})})]})]})}},7788:(e,t,a)=>{Promise.resolve().then(a.bind(a,6983))},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var s=a(5155),r=a(2115),l=a(9434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});i.displayName="Textarea"}},e=>{var t=t=>e(e.s=t);e.O(0,[519,874,627,213,595,441,684,358],()=>t(7788)),_N_E=e.O()}]);